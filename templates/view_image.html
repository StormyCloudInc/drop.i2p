<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Uploaded - I2P Secure Share</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tailwind.css') }}">
    <style>
        body { background-color: #1a202c; color: #cbd5e0; }
        .link-box { background-color: #2d3748; border: 1px solid #4a5568; word-break: break-all; }
        .btn { background-color: #4299e1; transition: background-color 0.3s ease; }
        .btn:hover { background-color: #3182ce; }
        .thumbnail-container { border: 2px dashed #4a5568; max-width: 100%; }
        .thumbnail { max-width: 100%; max-height: 60vh; object-fit: contain; }
        .announcement-bar { background-color: #2563eb; border-bottom: 1px solid #1e3a8a; }
    </style>
</head>
<body class="font-sans">

    <!-- Announcement Bar -->
{% if announcement_enabled and announcement_message %}
<div id="announcement-bar" class="announcement-bar text-white text-center p-2 relative shadow-lg">
    <span>{{ announcement_message }}</span>
    <button id="close-announcement" class="absolute top-0 right-0 mt-2 mr-4 text-white hover:text-gray-200 text-2xl leading-none">&times;</button>
</div>
{% endif %}

    <div class="flex items-center justify-center min-h-screen py-8">
        <div class="w-full max-w-2xl mx-auto p-4">
            <header class="text-center mb-8">
                <a href="/" class="inline-block mb-4">
                     <img src="{{ url_for('static', filename='images/stormycloud.svg') }}" alt="StormyCloud Logo" style="width: 550px; max-width: 100%;" class="mx-auto">
                </a>
                <h1 class="text-3xl font-bold text-white">Image Uploaded Successfully</h1>
                <p class="text-gray-400 mt-2">Share the link below. The file will be deleted based on the expiration you selected.</p>
            </header>

            <main class="flex-grow">
                <!-- Image Thumbnail -->
                <div class="thumbnail-container rounded-lg p-4 mb-6 flex justify-center items-center">
                    <img src="{{ url_for('get_upload', filename=filename) }}" alt="Uploaded Image" class="thumbnail rounded-md">
                </div>

                <!-- Share Link -->
                <div class="link-box rounded-lg p-4">
                    <label for="share-link" class="block text-gray-300 text-sm font-bold mb-2">Direct Image Link:</label>
                    <div class="flex items-center space-x-2">
                        <input type="text" id="share-link" class="bg-gray-700 text-white w-full p-2 border border-gray-600 rounded-md" value="{{ url_for('get_upload', filename=filename, _external=True) }}" readonly>
                        <button id="copy-button" class="btn text-white font-bold py-3 px-5 rounded-md focus:shadow-outline flex-shrink-0">Copy</button>
                    </div>
                </div>
                
                 <div class="text-center mt-8">
                    <a href="{{ url_for('index') }}" class="text-blue-400 hover:text-blue-300">Upload another file</a>
                </div>

                <!-- Subtle Donation Link -->
                 <div class="text-center mt-4 text-sm">
                     <p class="text-gray-500">Find this service useful? <a href="{{ url_for('donate_page') }}" class="text-blue-400 hover:underline">Consider supporting its future.</a></p>
                 </div>
            </main>
            
            <footer class="text-center text-gray-500 mt-16 border-t border-gray-700 pt-8 pb-8">
                 <a href="http://stormycloud.i2p" class="hover:text-gray-400">StormyCloud</a>
                 <span class="mx-2">|</span>
                 <a href="{{ url_for('donate_page') }}" class="hover:text-gray-400">Donate</a>
            </footer>

        </div>
    </div>

    <script>
        document.getElementById('copy-button').addEventListener('click', () => {
            const linkInput = document.getElementById('share-link');
            const button = document.getElementById('copy-button');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            try {
                document.execCommand('copy');
                button.textContent = 'Copied!';
                setTimeout(() => { button.textContent = 'Copy'; }, 2000);
            } catch (err) {
                console.error('Failed to copy text: ', err);
                button.textContent = 'Error';
            }
            window.getSelection().removeAllRanges();
        });

        const announcementBar = document.getElementById('announcement-bar');
        const closeButton = document.getElementById('close-announcement');
        if (closeButton) {
            closeButton.addEventListener('click', () => {
                announcementBar.style.display = 'none';
            });
        }
    </script>
</body>
</html>
